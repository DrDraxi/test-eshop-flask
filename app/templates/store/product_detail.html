{% extends "base.html" %}
{% block title %}{{ product.name }} - 3D Print Shop{% endblock %}
{% block content %}
<div class="container mx-auto px-4 py-8">
    <div class="grid md:grid-cols-2 gap-8">
        <!-- Image Gallery -->
        <div class="space-y-3">
            {% if product.images %}
            <div class="aspect-square bg-[hsl(var(--muted))] rounded-lg overflow-hidden">
                <img
                    id="main-image"
                    src="{{ product.images[0].url }}"
                    alt="{{ product.images[0].alt or product.name }}"
                    class="w-full h-full object-cover"
                >
            </div>
            {% if product.images|length > 1 %}
            <div class="flex gap-2 overflow-x-auto">
                {% for img in product.images %}
                <button
                    onclick="document.getElementById('main-image').src='{{ img.url }}'; document.querySelectorAll('.thumb-btn').forEach(b => b.classList.remove('border-[hsl(var(--primary))]')); this.classList.add('border-[hsl(var(--primary))]')"
                    class="thumb-btn w-20 h-20 rounded-md overflow-hidden flex-shrink-0 border-2 transition-colors {% if loop.first %}border-[hsl(var(--primary))]{% else %}border-transparent{% endif %}"
                >
                    <img src="{{ img.url }}" alt="{{ img.alt or product.name }}" class="w-full h-full object-cover">
                </button>
                {% endfor %}
            </div>
            {% endif %}
            {% else %}
            <div class="aspect-square bg-[hsl(var(--muted))] rounded-lg flex items-center justify-center text-[hsl(var(--muted-foreground))]">
                No Image Available
            </div>
            {% endif %}
        </div>

        <!-- Product Info -->
        <div>
            {% if product.category %}
            <p class="text-sm text-[hsl(var(--muted-foreground))] mb-2">{{ product.category }}</p>
            {% endif %}
            <h1 class="text-3xl font-bold mb-4">{{ product.name }}</h1>
            <p class="text-3xl font-bold text-[hsl(var(--primary))] mb-4">
                {{ product.price|format_price }}
            </p>

            {% if product.stock > 0 %}
            <span class="badge-secondary mb-6 inline-block">{{ product.stock }} in stock</span>
            {% else %}
            <span class="badge-destructive mb-6 inline-block">Out of Stock</span>
            {% endif %}

            {% if product.description %}
            <p class="text-[hsl(var(--muted-foreground))] mb-6 whitespace-pre-line">{{ product.description }}</p>
            {% endif %}

            <button
                onclick="addToCart('{{ product.id }}', '{{ product.name }}', {{ product.price }}, '{{ product.slug }}', '{{ product.images[0].url if product.images else '' }}')"
                {% if product.stock == 0 %}disabled{% endif %}
                class="btn-primary btn-lg gap-2 w-full md:w-auto"
            >
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="8" cy="21" r="1"/><circle cx="19" cy="21" r="1"/><path d="M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12"/></svg>
                Add to Cart
            </button>
        </div>
    </div>
</div>
{% endblock %}
