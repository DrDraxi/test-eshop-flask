{% extends "admin/base_admin.html" %}
{% block title %}Order #{{ order.order_number }}{% endblock %}
{% block content %}
<div class="max-w-3xl space-y-6">
    <div class="flex items-center justify-between">
        <div>
            <h1 class="text-3xl font-bold">Order #{{ order.order_number }}</h1>
            <p class="text-sm text-[hsl(var(--muted-foreground))]">{{ order.created_at.strftime("%Y-%m-%d %H:%M") }}</p>
        </div>
        {% with status=order.status %}{% include "partials/status_badge.html" %}{% endwith %}
    </div>

    <div class="grid md:grid-cols-2 gap-6">
        <div class="card">
            <div class="card-header"><h2 class="card-title text-lg">Customer</h2></div>
            <div class="card-content space-y-1 text-sm">
                <p class="font-medium">{{ order.customer_name }}</p>
                <p>{{ order.customer_email }}</p>
            </div>
        </div>
        <div class="card">
            <div class="card-header"><h2 class="card-title text-lg">Shipping Address</h2></div>
            <div class="card-content text-sm space-y-1">
                <p>{{ address.get("line1", "") }}</p>
                {% if address.get("line2") %}<p>{{ address.line2 }}</p>{% endif %}
                <p>{{ address.get("city", "") }}, {{ address.get("state", "") }} {{ address.get("postalCode", "") }}</p>
                <p>{{ address.get("country", "") }}</p>
            </div>
        </div>
    </div>

    <div class="card">
        <div class="card-header"><h2 class="card-title text-lg">Items</h2></div>
        <div class="card-content">
            <div class="space-y-3">
                {% for item in order.items %}
                <div class="flex justify-between text-sm">
                    <span>{{ item.product_name }} x {{ item.quantity }}</span>
                    <span>{{ (item.price_at_time * item.quantity)|format_price }}</span>
                </div>
                {% endfor %}
                <div class="separator"></div>
                <div class="flex justify-between text-sm">
                    <span>Subtotal</span><span>{{ order.subtotal|format_price }}</span>
                </div>
                <div class="flex justify-between text-sm">
                    <span>Shipping</span><span>{{ order.shipping_cost|format_price }}</span>
                </div>
                <div class="separator"></div>
                <div class="flex justify-between font-bold">
                    <span>Total</span><span>{{ order.total|format_price }}</span>
                </div>
            </div>
        </div>
    </div>

    {% include "partials/order_status_form.html" %}
</div>
{% endblock %}
